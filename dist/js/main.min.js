$(document).ready(function(){let e="PLPDiBuu9QLZbC1oiZnqAdoVHIMKcNvsLS",t="AIzaSyBPmtjOU7k9Bww0xM7CMIQ1huvIQvEYt_k",a=50,i=0;function s(){return console.log("Fetching videos from playlist..."),$.ajax({url:"https://www.googleapis.com/youtube/v3/playlistItems",data:{key:t,playlistId:e,part:"snippet",maxResults:a}}).then(e=>(console.log("Videos Response:",e),e.items.map(e=>{var t,a,i,s=e.snippet.title,o=(t=s,console.log("=== Video Title Parsing ==="),console.log("Original title:",t),t=(t=t.replace(/["']/g,"")).split(",").map(e=>e.trim()),console.log("Parts after split:",t),o=parseFloat(t[0])||0,a=t[1]?t[1].toLowerCase().trim():"",i=t[2]?t[2].toLowerCase().trim():"",t=t[3]?t[3].trim():"",console.log("Final parsed values:",{thickness:o,material:a,shape:i,alloy:t}),{thickness:o,material:a,shape:i,alloy:t});return{id:e.snippet.resourceId.videoId,title:s,thumbnail:e.snippet.thumbnails.medium.url,...o}}))).catch(e=>{throw console.error("API Error:",e),e})}function o(){var e=$(".material-checkbox:checked").map(function(){return $(this).siblings("label").text().trim()}).get().join(", ")||"Select Materials",t=$(".shape-checkbox:checked").map(function(){return $(this).siblings("label").text().trim()}).get().join(", ")||"Select Shapes",a=$(".alloy-checkbox:checked").map(function(){return $(this).siblings("label").text().trim()}).get().join(", ")||"Select Alloys";$("#material-filters .dropdown-toggle").text(e),$("#shape-filters .dropdown-toggle").text(t),$("#alloy-filters .dropdown-toggle").text(a)}function l(){$("#waitlist-popup").length||($("body").append(`
            <div id="waitlist-popup" class="popup-overlay">
                <div class="popup-content">
                    <div class="popup-header">
                        <button class="close-popup">&times;</button>
                    </div>
                    <div class="popup-body">
                        <div class="google-form-container">
                            <iframe src="https://forms.gle/fyBFM2qxMTon8YDu5"
                                frameborder="0"
                                marginheight="0"
                                marginwidth="0"
                                style="width:100%;height:1000px;">
                                Loading...
                            </iframe>
                        </div>
                    </div>
                </div>
            </div>
        `),$("#waitlist-popup").css("display","flex").hide().fadeIn(),$(".close-popup").on("click",function(){$("#waitlist-popup").fadeOut(function(){$(this).remove()})}),$("#waitlist-popup").on("click",function(e){e.target===this&&$(this).fadeOut(function(){$(this).remove()})}))}function n(o=[],l=[],n=[]){let r=parseFloat($("#thickness-min").val())||0,c=parseFloat($("#thickness-max").val())||.5;console.log("Applying filters with thickness range:",r,"to",c),$(".video-item").each(function(){var e=$(this),t=String(e.attr("data-material")||"").toLowerCase().trim(),a=String(e.attr("data-shape")||"").toLowerCase().trim(),i=String(e.attr("data-alloy")||"").toLowerCase().trim(),s=parseFloat(e.attr("data-thickness").replace(/['"]/g,""))||0,t=(console.log("Item thickness:",s,"Testing against range:",r,"-",c),0===o.length||o.map(e=>e.toLowerCase().trim()).includes(t)),a=0===l.length||l.map(e=>e.toLowerCase().trim()).includes(a),i=0===n.length||n.map(e=>e.toLowerCase().trim()).includes(i),s=s>=r&&s<=c;t&&a&&i&&s?e.show():e.hide()})}$("#thickness-range").slider({range:!0,min:0,max:.5,step:.001,values:[0,.5],slide:function(e,t){$("#thickness-min").val(t.values[0].toFixed(3)),$("#thickness-max").val(t.values[1].toFixed(3)),n($(".material-checkbox:checked").map(function(){return $(this).attr("data-filter")}).get(),$(".shape-checkbox:checked").map(function(){return $(this).attr("data-filter")}).get(),$(".alloy-checkbox:checked").map(function(){return $(this).attr("data-filter")}).get())}}),$("#thickness-min").val("0.000"),$("#thickness-max").val("0.500"),$("#thickness-min, #thickness-max").on("input",function(){var e=parseFloat($("#thickness-min").val())||0,t=parseFloat($("#thickness-max").val())||.5,e=($("#thickness-range").slider("values",[e,t]),$(".material-checkbox:checked").map(function(){return $(this).attr("data-filter")}).get());n(e,$(".shape-checkbox:checked").map(function(){return $(this).attr("data-filter")}).get(),$(".alloy-checkbox:checked").map(function(){return $(this).attr("data-filter")}).get())}),$("#reset-filters").click(function(){$(".filter-checkbox").prop("checked",!1),$("#thickness-range").slider("values",[0,.5]),$("#thickness-min").val("0.000"),$("#thickness-max").val("0.500"),o(),$(".video-item").each(function(){$(this).show()})}),$(document).on("click",".video-overlay",function(){var e=$(this).closest(".video-item"),t=e.attr("data-video-id"),e=e.find(".video-container"),t=($(this).remove(),e.find("img").remove(),$("<iframe>",{src:`https://www.youtube.com/embed/${t}?autoplay=1`,frameborder:"0",allowfullscreen:!0}));e.append(t),2===++i&&setTimeout(l,1e3)}),$("#thickness-range").slider({range:!0,min:0,max:.5,step:.001,values:[0,.5],slide:function(e,t){a=t.values[0],t=t.values[1],$("#thickness-min").val(a.toFixed(3)),$("#thickness-max").val(t.toFixed(3));var a=$(".material-checkbox:checked").map(function(){return $(this).attr("data-filter")}).get();n(a,$(".alloy-checkbox:checked").map(function(){return $(this).attr("data-filter")}).get())}}),$("#reset-filters").click(function(){$(".filter-checkbox").prop("checked",!1),$("#thickness-range").slider("values",[0,.5]),$("#thickness-min").val("0.000"),$("#thickness-max").val("0.500"),o();$(".video-item").each(function(){$(this).show()})}),$(document).on("click",".dropdown-toggle",function(e){e.stopPropagation();e=$(this).siblings(".dropdown-menu");$(".dropdown-menu").not(e).removeClass("show"),e.toggleClass("show")}),$(document).click(function(e){$(e.target).closest(".dropdown-container").length||$(".dropdown-menu").removeClass("show")}),$(document).on("click",".done-button",function(e){e.stopPropagation();var e=$(".material-checkbox:checked").map(function(){return $(this).attr("data-filter")}).get(),t=$(".shape-checkbox:checked").map(function(){return $(this).attr("data-filter")}).get(),a=$(".alloy-checkbox:checked").map(function(){return $(this).attr("data-filter")}).get();$(this).closest(".dropdown-menu").removeClass("show"),n(e,t,a),o()}),$(document).on("click",".checkbox-options",function(e){e.stopPropagation()}),$(document).on("change",".filter-checkbox",function(){o()}),$("#thickness-min, #thickness-max").on("input",function(){var e=parseFloat($("#thickness-min").val())||0,t=parseFloat($("#thickness-max").val())||.5;"thickness-min"===$(this).attr("id")&&t<e?$(this).val(t):"thickness-max"===$(this).attr("id")&&t<e?$(this).val(e):($("#thickness-range").slider("values",[e,t]),n($(".material-checkbox:checked").map(function(){return $(this).attr("data-filter")}).get(),$(".alloy-checkbox:checked").map(function(){return $(this).attr("data-filter")}).get()))}),$("#thickness-min, #thickness-max").on("blur",function(){var e=parseFloat($(this).val())||0,e=Math.max(0,Math.min(1,e));$(this).val(e.toFixed(3))}),$("#reset-filters").click(function(){$(".filter-checkbox").prop("checked",!1),$("#thickness-range").slider("values",[0,.5]).slider("option","values",[0,.5]),$("#thickness-min").val("0.000"),$("#thickness-max").val("0.500"),$("#thickness-range").trigger("slide"),o(),n([],[])}),s().then(e=>{{var s=e;let t=new Set,a=new Set,i=new Set;s.forEach(e=>{e.material&&t.add(e.material.toLowerCase().trim()),e.shape&&a.add(e.shape.toLowerCase().trim()),e.alloy&&i.add(e.alloy.toLowerCase().trim())}),$("#material-menu .checkbox-options").empty(),$("#shape-menu .checkbox-options").empty(),$("#alloy-menu .checkbox-options").empty(),t.forEach(e=>{var t=e.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");$("#material-menu .checkbox-options").append(`
                <div class="checkbox-wrapper">
                    <input type="checkbox" class="filter-checkbox material-checkbox" 
                           data-filter="${e}" id="material-${e.replace(/\s+/g,"-")}">
                    <label for="material-${e.replace(/\s+/g,"-")}">${t}</label>
                </div>
            `)}),a.forEach(e=>{var t=e.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");$("#shape-menu .checkbox-options").append(`
                <div class="checkbox-wrapper">
                    <input type="checkbox" class="filter-checkbox shape-checkbox" 
                           data-filter="${e}" id="shape-${e.replace(/\s+/g,"-")}">
                    <label for="shape-${e.replace(/\s+/g,"-")}">${t}</label>
                </div>
            `)}),i.forEach(e=>{var t=e.includes("nylon")?e.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):e.toUpperCase();$("#alloy-menu .checkbox-options").append(`
                <div class="checkbox-wrapper">
                    <input type="checkbox" class="filter-checkbox alloy-checkbox" 
                           data-filter="${e}" id="alloy-${e.replace(/\s+/g,"-")}">
                    <label for="alloy-${e.replace(/\s+/g,"-")}">${t}</label>
                </div>
            `)})}$(".gallery").empty(),e.forEach(e=>{console.log("Creating video item with:",e);var t=(t=e)&&t.material&&t.alloy?(t.material||"").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")+` ${(t.alloy||"").includes("nylon")?(t.alloy||"").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):(t.alloy||"").toUpperCase()} (${t.thickness||""}") Material Properties Demonstration`:(console.log("Invalid video data:",t),"Material Properties Demonstration"),a=(a=e)&&a.material&&a.alloy?(a.material||"").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")+` ${(a.alloy||"").includes("nylon")?(a.alloy||"").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):(a.alloy||"").toUpperCase()} material test video showing physical properties`:"Material test video",i=(i=e)&&i.material&&i.alloy?`Video demonstration of ${(i.material||"").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")} ${(i.alloy||"").includes("nylon")?(i.alloy||"").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):(i.alloy||"").toUpperCase()} material properties, thickness ${i.thickness||""} inches`:"Material properties demonstration video";$(".gallery").append(`
                    <div class="video-item" 
                        data-material="${e.material}" 
                        data-shape="${e.shape}"
                        data-alloy="${e.alloy}" 
                        data-thickness="${e.thickness}" 
                        data-video-id="${e.id}">
                        <div class="video-container">
                            <div class="video-overlay">
                                <div class="overlay-text">${e.title}</div>
                                <div class="play-button"></div>
                            </div>
                            <img src="${e.thumbnail}" 
                                title="${t}"
                                alt="${a}"
                                aria-label="${i}" />
                        </div>
                        <div class="video-info">
                            <div class="video-tags">
                                <span class="tag">Material: ${e.material}</span>
                                <span class="tag">Shape: ${e.shape}</span>
                                <span class="tag">Alloy: ${e.alloy}</span>
                                <span class="tag">Thickness: ${e.thickness}</span>
                            </div>
                        </div>
                    </div>
                `)})}).catch(e=>{console.error("Error fetching videos:",e),$(".gallery").html("<p>Error loading videos. Please try again later.</p>")})});